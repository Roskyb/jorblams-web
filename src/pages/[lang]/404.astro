---
import { LOCALES, type Lang, localeParams, useTranslations } from "@/i18n";
import Layout from "@/layouts/Base.astro";
const t = useTranslations(Astro.currentLocale as Lang);

const title = t("404.title");

export const getStaticPaths = () => localeParams;
---

<Layout {title}>
  <main class="min-h-screen bg-black text-white flex items-center justify-center px-8">
    <div class="max-w-2xl text-center">
      <!-- 404 Number -->
      <div class="mb-8">
        <h1 class="text-[12rem] md:text-[16rem] font-bold leading-none text-amber-200 opacity-80">
          404
        </h1>
      </div>

      <!-- Title -->
      <h2 class="text-3xl md:text-5xl font-bold mb-6">
        {title}
      </h2>

      <!-- Message -->
      <p class="text-gray-400 text-lg mb-12 leading-relaxed">
        {t("404.message")}
      </p>

      <!-- Back Home Button -->
      <a 
        href="/" 
        class="custom-cursor-trigger btn-trigger btn-primary z-50"
      >
        <span class="relative z-10">{t("404.top.page")}</span>
      </a>
      


      <!-- Language Selector -->
      <section class="mt-16 pt-12 border-t border-white/10">
        <h3 class="text-sm text-gray-500 mb-6 uppercase tracking-wider">
          {
            t({
              en: "View in other languages",
              es: "Ver en otros idiomas",
            })
          }
        </h3>

        <ul class="flex gap-4 justify-center flex-wrap">
          {
            Object.entries(LOCALES).map(([lang, { label }]) => (
              <li>
                <a
                  href={`/${lang}/`}
                  data-lang-path={lang}
                  onclick={`localStorage.selectedLang = "${lang}"`}
                  dir={LOCALES[lang].dir || null}
                  class="text-sm px-4 py-2 rounded-full border border-white bg-transparent text-white hover:bg-white hover:text-black transition-all duration-300"
                >
                  {label}
                </a>
              </li>
            ))
          }
        </ul>
      </section>
    </div>
  </main>
</Layout>

<script is:inline>
  if (localStorage.userAccessPath) {
    history.replaceState("", "", localStorage.userAccessPath);

    document.querySelectorAll("a[data-lang-path]").forEach((a) => {
      const pathnames = localStorage.userAccessPath.split("/");
      const lang = a.getAttribute("data-lang-path");
      pathnames[1] = lang;
      a.href = pathnames.join("/");
    });

    localStorage.removeItem("userAccessPath");
  }
</script>

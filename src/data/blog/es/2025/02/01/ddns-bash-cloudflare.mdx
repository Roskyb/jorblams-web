---
title: DNS din치mico con bash y crontab con cloudflare
description: Actualiza la IP de tu DNS a trav칠s de un script y crontab
date: 2025-02-01T10:00:00
lastModified: 2025-02-01T10:00:00
author: es/john-doe
cover: ../../../../2025/11/03/image-mesh-gradient (2).png
tags:
  - es/test
category: es/test
draft: false
---
## Qu칠 es un DDNS

Es un servicio que actualiza autom치ticamente la direcci칩n IP p칰blica de un dominio cuando cambia.  
Es 칰til para conexiones a internet con IP din치mica, como la que tienen la mayor칤a de las personas en sus casas.  
Utilizar este tipo de servicio nos permite mantener actualizada la IP de nuestro router (suele variar cuando se reinicia o, por ejemplo, cuando sufrimos un corte de luz).

## Qu칠 necesito

- Ordenador con Linux o m치quina virtual con acceso a internet
- Cuenta en Cloudflare con un dominio comprado

## Paso 1: Conseguir los datos necesarios de Cloudflare

Primero, entramos a nuestra cuenta de Cloudflare en la p치gina de inicio.

Una vez dentro, vamos a **DNS > Record**  
![img.png](/cloudflare/dns-record-menu.webp)

Despu칠s, creamos un nuevo registro apuntando a nuestra IP actual o a una ficticia, ya que ser치 temporal.  
![img_1.png](/cloudflare/dns-record-creation.webp)

Ahora necesitaremos el **ZONE ID**, que podemos conseguir desde la secci칩n de **Overview**.  
![img_1.png](/cloudflare/zone-id.webp)

Tambi칠n necesitaremos crear una **API Key** para usarla en el script.  
![img_1.png](/cloudflare/my-profile.webp)

Nos movemos a la secci칩n de **API tokens**  
![img_1.png](/cloudflare/api-tokens.webp)

Creamos un nuevo token y elegimos la plantilla de **"Edit zone DNS"**.  
Una vez dentro, solo tenemos que cambiar la zona a la que apunta.  
![img_1.png](/cloudflare/create-token-screen.webp)

Guardamos y creamos el token. Nos dar치 la opci칩n de copiarlo. **C칩pialo y gu치rdalo para usarlo m치s tarde en el script.**

## Paso 2: Crear el script

Crear un usuario para el script. Puedes utilizar uno que ya tengas si as칤 lo deseas.

```bash
sudo adduser --disabled-password --gecos "" cloudflare-ddns
```

Cambiamos al nuevo usuario:

```bash
sudo su cloudflare-ddns
```

Lanzamos los siguientes comandos:

```bash
mkdir $HOME/cloudflare-ddns/; cd $HOME/cloudflare-ddns/; \
wget https://raw.githubusercontent.com/fire1ce/DDNS-Cloudflare-Bash/main/update-cloudflare-dns.sh; \
wget https://raw.githubusercontent.com/fire1ce/DDNS-Cloudflare-Bash/main/update-cloudflare-dns.conf; \
chown $USER:$USER -R $HOME/cloudflare-ddns; chmod 600 update-cloudflare-dns.conf; \
chmod 700 update-cloudflare-dns.sh
```

Editamos el archivo `.conf` y cambiamos las variables con los datos que hemos conseguido previamente de Cloudflare.

```bash
nano $HOME/cloudflare-ddns/update-cloudflare-dns.conf
```

![img_1.png](/cloudflare/script_config.webp)

Ahora podemos probar a ejecutar el script:

```bash
./update-cloudflare-dns.sh ./update-cloudflare-dns.conf
```

Si no da ning칰n error, enhorabuena. Puedes a침adir a **crontab** la ejecuci칩n de este script:

```bash
# crontab -e
* * * * * $HOME/cloudflare-ddns/update-cloudflare-dns.sh update-cloudflare-dns.conf
# ctrl+o (guardar) > ctrl + x (salir)
```

Y listo. Con esto el script estar치 funcionando y no tendr치s que preocuparte de actualizar el DNS cada vez que cambie. 游
